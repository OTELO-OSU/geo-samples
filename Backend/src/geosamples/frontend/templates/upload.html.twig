{% include 'header.html.twig' %}
	
<script type="text/javascript" src="/jsonform/jquery.min.js"></script>
<script type="text/javascript" src="/jsonform/underscore.js"></script>
<script type="text/javascript" src="/jsonform/jsv.js"></script>
<script type="text/javascript" src="/jsonform/jsonform.js"></script>
<script type="text/javascript" src="/js/jquery.chained.js"></script>
<script type="text/javascript" src="/js/jquery.csv.js"></script>
<script type="text/javascript" src="/js/datepicker.js"></script>

  <script src="/css/semantic/dist/semantic.min.js">
  </script>
<link rel="stylesheet" type="text/css" href="/css/datepicker.css" />
<link rel="stylesheet" type="text/css" href="/jsonform/css/bootstrap.css" />
<div class="ui grid container">
	<div class="row">
    <h1 class="ui dividing header">Upload new data</h1>
  </div>
	<div class="ui twelve wide column centered ">
	<div id="inputs" class="ui ten wide column">
   <a href="/template_meta/template_metadata.csv"> <div class="text" >Download metadata template<i  id="donwloadmetadata" class="download large blue icon"> </i></div> </a>
   <div class="text" id="file-select-button">Click here to import metadata from a csv file<i id="uploadmetadata" class="upload large green icon"></i></div> 
   <input hidden type="file" id="metadatafile" name="metadata" />
  </div>
   <div id="warning" class="ui fourteen wide column centered">
      {% if error %}
      <div class="ui warning message">
         <div class="header">
            Warning!  
         </div>
         {{error}}
      </div>
      {% endif %}
		<form method="post" action="/{{route}}" class="ui form" name="form" enctype="multipart/form-data">
			





		<div class="ui error message"></div>
		<a href="javascript:history.back();" class="ui red button"><i class="cancel icon"></i>Cancel</a>
<button type="submit" class="ui submit right floated green  button"><i class="checkmark icon"></i>Submit</button>
{%if edit%}
		<a onclick="remove();" class="ui  black  button"><i class="trash alternate icon"></i>Remove</a>		
{%endif%}
</form>		
	</div>
</div>

 <div class="ui modal remove">
     <i class="close icon"></i>
     <div class="header">
     </div>
     <div class="content">       
     </div>
 </div>

<script type="text/javascript">
	 $("body").on("click", ".delete", function(e) {
                  $(this).parent("div").remove();
              });
	function remove(){
		 $(".modal.remove .header").empty();
         $(".modal.remove .content").empty();
         $(".modal.remove .header").append('Are you sure to remove {{id}} ?  ');
         $(".modal.remove .content").append('<form class="ui form " action="/delete_data" method="post"><input type="hidden" name="csrf_name" value=""><input type="hidden" name="csrf_value" value=""><input type="hidden" name="id" value="{{id}}"> <div class="actions"> <div class="ui black deny button"> Cancel </div> <button class="ui submit green button" >Yes</button> </div> </form>');
         $('.ui.modal.remove').modal('show');
	}
	JSONForm.fieldTypes['file_data_already_uploaded'] = {
		  template: '<%=node.value%>'
		};

	JSONForm.fieldTypes['lithology'] = {
		  template: '<%=node.value%>'
		};
		JSONForm.fieldTypes['texture'] = {
		  template: '<%=node.value%>'
		};
		JSONForm.fieldTypes['ore_type'] = {
		  template: '<%=node.value%>'
		};
		
		$('form').jsonForm({% include 'form_'~collection_name~'.html.twig' %});

		function switch_measurement(){

				value= $( "select[name='measurements[].abbreviation']" ).val();
				{%if collection_name == 'petrophysics'%}
				switch (value) {
				  case 'AMS':
					  nature="Anisotropy of Magnetic Susceptibility without ferrofluid" ;
					  unit="SI" ;
				   break;
				   case 'Tcond-D':
					  nature="Thermal Conductivity dry" ;
					  unit="W/m/K" ;
				   break;
				   case 'Tdif-D':
					  nature="Thermal Diffusivity dry" ;
					  unit="mm2/s" ;
				   break;
				   case 'P-Wave-D':
					  nature="P-wave Velocity dry" ;
					  unit="m/s" ;
				   break;
				   case 'S-Wave-D':
					  nature="S-wave Velocity dry" ;
					  unit="m/s" ;
				   break;
				   case 'GD':
					  nature="Grain Density";
					  unit="g/cm3" ;
				   break;
				   case 'Porosity-TW':
					  nature="Triple Weight Porosity" ;
					  unit="%" ;
				   break;
				   case 'Porosity-He':
					  nature="Helium Porosity" ;
					  unit="%" ;
				   break;
				   case 'Perm-Ni':
					  nature="Permeability Nitrogen" ;
					  unit="m2" ;
				   break;
				   case 'AMS-ferro':
					  nature="Anisotropty of Magnetic Susceptibility with ferrofluid saturation" ;
					  unit="SI" ;
				   break;
				   case 'Porosity-Hg':
					  nature="Mercury Porosity" ;
					  unit="%" ;
				   break;
				   case 'GD-powder':
					  nature="Grain Density with powder porphyriser" ;
					  unit="g/cm3" ;
				   break;
				   case 'S-Wave-W':
					  nature="S-wave Velocity wet" ;
					  unit="m/s" ;
				   break;
				   case 'SHC':
					  nature="Specific Heat Capacity" ;
					  unit="kJ/kg/K" ;
				   break;
				   case 'Tdif-W':
					  nature="Thermal Diffusivity wet" ;
					  unit="mm2/s" ;
				   break;
				   case 'Tcond-W':
					  nature="Thermal Conductivity wet" ;
					  unit="W/m/K" ;
				   break;
				   case 'Perm-F':
					  nature="Field Permeameter" ;
					  unit="m2" ;
				   break;
				   case 'P-Wave-W':
					  nature="P-wave Velocity wet" ;
					  unit="m/s" ;
				   break;
				     case 'MS':
					  nature="Magnetic susceptibility" ;
					  unit="SI" ;
				   break;
				 
				}
				{%endif%}

				{%if collection_name == 'scandium'%}
				switch (value) {
				 
				   case 'BGC':
					  nature="BULK_GEOCHEM" ;
					  unit="%WT_AND_PPMWT" ;
				   break;
				   case 'EMPA':
					  nature="ELECTRONIC_MICROPROBE" ;
					  unit="%WT" ;
				   break;
				   case 'LAICPMS':
					  nature="LA-ICP-MS" ;
					  unit="PPMWT" ;
				   break;
				 
				}

				{%endif%}


				{%if collection_name == 'acev'%}
				switch (value) {
				   case 'PHY-CHEM':
					  nature="PHY-CHEM" ;
					  unit="Text" ;
				   break;				 
				}

				{%endif%}


				$( "input[name='measurements[].nature']" ).val(nature);
				$( "input[name='measurements[].unit']" ).val(unit);
		  
		
		}

		 $(function() {
		 	$('.ui.accordion')
			  .accordion()
			  $( ".submit" ).click(function() {
				 $('.ui.accordion').each(function(i){
				    $(this).parent().accordion('open',i);
				});
			});
			  $('[name="sampling_date"]').datepicker({ format: 'yyyy-mm-dd'});

			$("input[name='core']").click(function(){

			var block=$("input[name='core']:checked").val();
            if(block=='Yes'){
                var radios = $('input:radio[name=block]');
                radios.filter('[value=No]').prop('checked', true);
                console.log("test")
                

            }else{
            	 var radios = $('input:radio[name=block]');
                radios.filter('[value=No]').prop('checked', false);

            }
        });
				$("input[name='block']").click(function(){

			var core=$("input[name='block']:checked").val();
            if(core=='Yes'){
                var radios = $('input:radio[name=core]');
                radios.filter('[value=No]').prop('checked', true);
                $('.form-group.jsonform-error-core_depth').addClass("hidden field");
        $('.form-group.jsonform-error-core_azimut').addClass("hidden field");
        $('.form-group.jsonform-error-core_dip').addClass("hidden field");

            }else{
            	 var radios = $('input:radio[name=core]');
                radios.filter('[value=No]').prop('checked', false);

            }
        });

			
		$("#jsonform-1-elt-lithology2").chained("#jsonform-1-elt-lithology1");
		$("#jsonform-1-elt-lithology3").chained("#jsonform-1-elt-lithology2");
		$("#jsonform-1-elt-texture2").chained("#jsonform-1-elt-texture1");
		$("#jsonform-1-elt-texture3").chained("#jsonform-1-elt-texture2");
		$("#jsonform-1-elt-oretype2").chained("#jsonform-1-elt-oretype1");
		$("#jsonform-1-elt-oretype3").chained("#jsonform-1-elt-oretype2");
		$( "select[name='measurements[].abbreviation']" ).change(function() {
			switch_measurement();

		});

	});

$('.ui.form')
  .form({
    fields: {

data:{
	identifier: 'data',
	rules:[
	{
        type   : 'regExp',
        value  : '/^(.*.((csv|xlsx)$))?[^.]*$/i',
        prompt : 'Please upload a file in suggested format (CSV,XLSX)'
      }
 ]
},
pictures:{
	identifier: 'pictures',
	rules:[
	{
        type   : 'regExp',
        value  : '/^(.*.((jpeg|gif|png|tiff|jpg)$))?[^.]*$/i',
        prompt : 'Please upload a file in suggested format (CSV,XLSX)'
      }
 ]
},

      title: {
        identifier: 'title',
        rules: [
          {
            type   : 'empty',
            prompt : 'Please enter a title'
          }
        ]
      },
       sample_name: {
        identifier: 'sample_name',
        rules: [
          {
            type   : 'regExp[/^(?!_)[A-z0-9](?!_)*((-|)(?!_)*(?!_)[A-z0-9])*$/]',
            prompt : 'Please enter a sample name'
          }
        ]
      },
       sampling_date: {
        identifier: 'sampling_date',
        rules: [
          {
            type   : 'empty',
            prompt : 'Please enter a sampling date'
          }
        ]
      },
       keywords: {
        identifier: 'keywords[0].keyword',
        rules: [
          {
            type   : 'empty',
            prompt : 'Please enter at least one keyword'
          }
        ]
      },
       institutions: {
        identifier: 'institution[0].institution',
        rules: [
          {
            type   : 'empty',
            prompt : 'Please enter at least one institution'
          }
        ]
      },

       description: {
                          identifier: 'description',
                          rules: [{
                              type: 'empty',
                              prompt: 'Please enter description'
                          }]
                      },
       scientific_field: {
                          identifier: 'scientific_fields[0].scientific_field',
                          rules: [{
                              type: 'empty',
                              prompt: 'Please enter a scientific field'
                          }]
        },

       institutions: {
                          identifier: 'institution[0].institution',
                          rules: [{
                              type: 'empty',
                              prompt: 'Please enter institution'
                          }]
                      },
        sampling_points_name: {
                          identifier: 'sampling_points.NAME',
                          rules: [{
                              type: 'empty',
                              prompt: 'Please enter sampling point name'
                          }]
                      },
          sampling_points_COORDINATE_SYSTEM: {
                          identifier: 'sampling_points.COORDINATE_SYSTEM',
                          rules: [{
                              type: 'empty',
                              prompt: 'Please enter sampling point COORDINATE SYSTEM'
                          }]
                      },
           sampling_points_LONGITUDE: {
                          identifier: 'sampling_points.LONGITUDE',
                          rules: [{
                              type: 'regExp[/^(\\-?\\d+(\\.\\d+)?).\\s*(\\-?\\d+(\\.\\d+)?)$/]',
                              prompt: 'Please enter sampling point LONGITUDE'
                          }]
             },
            sampling_points_LATITUDE: {
                          identifier: 'sampling_points.LATITUDE',
                          rules: [{
                              type: 'regExp[/^(\\-?\\d+(\\.\\d+)?).\\s*(\\-?\\d+(\\.\\d+)?)$/]',
                              prompt: 'Please enter sampling point LATITUDE'
                          }]
             },
             sampling_points_ELEVATION: {
                          identifier: 'sampling_points.ELEVATION_M',
                          rules: [{
                              type: 'number',
                              prompt: 'Please enter sampling point ELEVATION'
                          }]
             },
               core: {
                          identifier: 'core',
                          rules: [{
                              type: 'checked',
                              prompt: 'Please specify core'
                          }]
             },
        
          block: {
                          identifier: 'block',
                          rules: [{
                              type: 'checked',
                              prompt: 'Please specify block'
                          }]
             },
            
        
        
      
    }
  })
;



$('.ui.dropdown[name*="scientific_fields"]')
  .dropdown({
    allowAdditions: true,
  })
;
$('.ui.dropdown[name*="institution"]')
  .dropdown({
    allowAdditions: true
  })
;
      $('.institutions div.text').html('Select a field or type one ')
      $('.scientific_fields div.text').html('Select a field or type one')

  {%for key,institution in institutions%}
        $('.institutions div.text').html('')

  if ($('.institutions input.search')[{{key}}].value=="") {
 
      $('.institutions input.search')[{{key}}].value='{{institution.NAME}}'
  }
;
    {%endfor%}

   {%for key,scientific_field in scientific_fields%}
         $('.scientific_fields div.text').html('')


  if ($('.scientific_fields input.search')[{{key}}].value=="") {
      $('.scientific_fields input.search')[{{key}}].value='{{scientific_field.NAME}}'
   
  }
;
    {%endfor%}

      {%if measurement_abbv%}

     $('select[name*=measurements]').val('{{measurement_abbv}}');
     switch_measurement();
  

    {%endif%}

     {%if methodology_sampling%}

     $('input[name*=methodology]')[0].value='{{methodology_sampling}}';
  

    {%endif%}

     {%if methodology_conditionning%}

     $('input[name*=methodology]')[1].value='{{methodology_conditionning}}';
  

    {%endif%}

     {%if methodology_sample_storage%}

     $('input[name*=methodology]')[2].value='{{methodology_sample_storage}}';
  

    {%endif%}

	{%if sampling_points%}
	{%for key,sampling_point in sampling_points%}
		{%for key,sampling_point in sampling_point%}

     $('.sampling_point input[name*={{key}}]').val('{{sampling_point}}');
     {%endfor%}
      {%endfor%}
  

    {%endif%}

function handleFileSelect(evt) {
                  $('#inputs #filenamemetadata').remove();
                  var files = evt.target.files; // FileList object
                  var file = files[0];
                  if (file['type'] == 'text/csv') {
                      var reader = new FileReader();
                      reader.readAsText(file);
                      reader.onload = function(event) {
                          var csv = event.target.result;
                          console.log(csv)
                          var data = $.csv.toArrays(csv);
                          if (data.length == 0) {
                              alert('Your CSV file is empty!')
                          } else {
                              if ($("input[name='title']").val() != "") {
                                  $('form')[1].reset();
                              }
                              $('.delete').parent().remove();
                              name = "";
                              firstname = "";
                              mail = "";
                              keyword=0;
                              institutions=0;
                              $.each(data, function(index, values) {
                                  $.each(values, function(index, value) {
                                      if (value != "") {
                                          if (value == "TITLE") {
                                              $("input[name='title']").val(values[1]);
                                          }
                                           if (value == "SAMPLE_NAME") {
                                              $("input[name='sample_name']").val(values[1]);
                                          }
                                           if (value == "SAMPLING_DATE") {
                                              $("input[name='sampling_date']").val(values[1]);
                                          }

                                            if (value == "SAMPLE_LOCATION_FACILITY") {
                                              $("input[name='sample_location_facility']").val(values[1]);
                                          }
                                            if (value == "SAFETY_CONSTRAINTS") {
                                              $("input[name='SAFETY_CONSTRAINTS']").val(values[1]);
                                          }
                                            if (value == "STORAGE_DETAILS") {
                                              $("input[name='STORAGE_DETAILS']").val(values[1]);
                                          }
                                            if (value == "SUBSTANCE") {
                                              $("input[name='SUBSTANCE']").val(values[1]);
                                          }
                                            if (value == "HOST_AGE") {
                                              $("input[name='HOST_AGE']").val(values[1]);
                                          }
                                            if (value == "MAIN_EVENT_AGE") {
                                              $("input[name='MAIN_EVENT_AGE']").val(values[1]);
                                          }
                                            if (value == "OTHER_EVENT_AGE") {
                                              $("input[name='OTHER_EVENT_AGE']").val(values[1]);
                                          }
                                            if (value == "ALTERATION_DEGREE") {
                                              $("input[name='ALTERATION_DEGREE']").val(values[1]);
                                          }
                                            if (value == "HOST_LITHOLOGY_OR_PROTOLITH") {
                                              $("input[name='HOST_LITHOLOGY_OR_PROTOLITH']").val(values[1]);
                                          }

                                           if (value == "LITHOLOGY") {
                                              $("select[name='lithology1']").val(values[1]);
                                          }
                                           if (value == "LITHOLOGY_2") {
                                           	   $("select[name='lithology2']").prop('disabled', false);
                                           	   var o = new Option(values[1], values[1]);
												$(o).html(values[1]);
												$("select[name='lithology2']").append(o);
												$("select[name='lithology2']").val(values[1]);

                                          }
                                           if (value == "LITHOLOGY_3") {
                                           	$("select[name='lithology3']").prop('disabled', false);
                                           	var o = new Option(values[1], values[1]);
												$(o).html(values[1]);
												$("select[name='lithology3']").append(o);
												$("select[name='lithology3']").val(values[1]);
                                          }

                                           if (value == "TEXTURE_STRUCTURE_1") {
                                              $("select[name='texture1']").val(values[1]);
                                          }
                                           if (value == "TEXTURE_STRUCTURE_2") {
                                           	   $("select[name='texture2']").prop('disabled', false);
                                           	   var o = new Option(values[1], values[1]);
												$(o).html(values[1]);
												$("select[name='texture2']").append(o);
												$("select[name='texture2']").val(values[1]);

                                          }
                                           if (value == "TEXTURE_STRUCTURE_3") {
                                           	$("select[name='texture3']").prop('disabled', false);
                                           	var o = new Option(values[1], values[1]);
												$(o).html(values[1]);
												$("select[name='texture3']").append(o);
												$("select[name='texture3']").val(values[1]);
                                          }

                                          if (value == "ORE_TYPE_1") {
                                              $("select[name='oretype1']").val(values[1]);
                                          }
                                           if (value == "ORE_TYPE_2") {
                                           	   $("select[name='oretype2']").prop('disabled', false);
                                           	   var o = new Option(values[1], values[1]);
												$(o).html(values[1]);
												$("select[name='oretype2']").append(o);
												$("select[name='oretype2']").val(values[1]);

                                          }
                                           if (value == "ORE_TYPE_3") {
                                           	$("select[name='oretype3']").prop('disabled', false);
                                           	var o = new Option(values[1], values[1]);
												$(o).html(values[1]);
												$("select[name='oretype3']").append(o);
												$("select[name='oretype3']").val(values[1]);
                                          }
                                          

                                           if (value == "SAMPLING_POINT") {
                                              $("input[name='sampling_points[].NAME']").val(values[1]);
                                              $("select[name='sampling_points[].COORDINATE_SYSTEM']").val(values[2]);
                                              $("input[name='sampling_points[].ABBREVIATION']").val(values[3]);
                                              $("input[name='sampling_points[].LONGITUDE']").val(values[4]);
                                              $("input[name='sampling_points[].LATITUDE']").val(values[5]);
                                              $("input[name='sampling_points[].ELEVATION_M']").val(values[6]);
                                              $("input[name='sampling_points[].DESCRIPTION']").val(values[7]);
                                              $("input[name='sampling_points[].SAMPLING']").val(values[8]);




                                          }
                                           if (value == "MEASUREMENT") {
                                              $("input[name='measurements[].nature']").val(values[1]);
                                              $("select[name='measurements[].abbreviation']").val(values[2]);
                                              $("input[name='measurements[].unit']").val(values[3]);
                                          }
                                           if (value == "CORE") {

                                           	if(values[1].toUpperCase()=='YES'){
								                var radios = $('input:radio[name=core]');
								                radios.filter('[value=Yes]').prop('checked', true);
								                 $('.form-group.jsonform-error-core_depth').removeClass("hidden field");
										        $('.form-group.jsonform-error-core_azimut').removeClass("hidden field");
										        $('.form-group.jsonform-error-core_dip').removeClass("hidden field");
										      $("input[name='core_depth']").val(values[2]);
                                              $("input[name='core_azimut']").val(values[3]);
                                              $("input[name='core_dip']").val(values[4]);


								            }else{
								            	 var radios = $('input:radio[name=core]');
								                radios.filter('[value=No]').prop('checked', true);

								            }
                                              
                                          }
                                           if (value == "BLOCK") {
                                           	if(values[1].toUpperCase()=='YES'){
								                var radios = $('input:radio[name=block]');
								                radios.filter('[value=Yes]').prop('checked', true);

								            }else{
								            	 var radios = $('input:radio[name=block]');
								                radios.filter('[value=No]').prop('checked', true);

								            }
                                              
                                           
                                          }
                                          if (value == "PULP") {
                                           	if(values[1].toUpperCase()=='YES'){
								                var radios = $('input:radio[name=pulp]');
								                radios.filter('[value=Yes]').prop('checked', true);

								            }else{
								            	 var radios = $('input:radio[name=pulp]');
								                radios.filter('[value=No]').prop('checked', false);

								            }
                                              
                                           
                                          }

                                          if (value == "KEYWORD") {
                                          	    keyword = $('.Keywords input').length;
                                          	    console.log(keyword)
                                              if (keyword <= 2) {
                                                  if ($("input[name='keywords[0].keyword']").val() != "") {
                                                      $(".Keywords fieldset ul").append('<li data-idx="'+keyword+'"><div id="jsonform-1-elt-counter-3"><div class="form-group jsonform-error-keywords[0]---keyword jsonform-required required field"><label for="jsonform-1-elt-keywords['+keyword+'].keyword">Keyword</label><div class="controls field"><input type="text" class="form-control input-lg " name="keywords['+keyword+'].keyword" data-validate="keywords['+keyword+'].keyword" value="'+values[1]+'" id="jsonform-1-elt-keywords[0].keyword" required="required" placeholder="Keyword"><span class="help-block jsonform-errortext" style="display:none;"></span></div></div></div></li>');
                                                  } else {
                                                      $("input[name='keywords[0].keyword']").val(values[1]);
                                                  }
                                              }


                                          }
                                           if (value == "INSTITUTION") {
                                          	    institutions = $('.Institutions select').length;
                                          	    console.log(institutions)
                                              if (institutions <= 2) {
                                                  if ($(".institutions input.search").val() != "") {
                                                      $(".Institutions fieldset ul").append('<li data-idx="'+institutions+'"><div id="jsonform-1-elt-counter-5"><div class="form-group jsonform-error-institution['+institutions+']---institution jsonform-required required field"><label for="jsonform-1-elt-institution['+institutions+'].institution">Institution</label><div class="controls field"><div class="ui fluid search dropdown form-control selection"><select name="institution['+institutions+'].institution" id="jsonform-1-elt-institution['+institutions+'].institution" required="required">  <option selected="" value="'+value[1]+'"></option> <option value="ADIT Agency for the dissemination of technological information">ADIT Agency for the dissemination of technological information</option> <option value="ANDRA National Agency for Radioactive Waste Management">ANDRA National Agency for Radioactive Waste Management</option> <option value="B.R.G.M. THE FRENCH GEOLOGICAL SURVEY">B.R.G.M. THE FRENCH GEOLOGICAL SURVEY</option> <option value="C.E.A. The French Alternative Energies and Atomic Energy Commission">C.E.A. The French Alternative Energies and Atomic Energy Commission</option> <option value="C.E.E. Center for Employment Studies">C.E.E. Center for Employment Studies</option> <option value="CEPH Human plymorphism Study Center">CEPH Human plymorphism Study Center</option> <option value="CIRAD Agricultural Research for development">CIRAD Agricultural Research for development</option> <option value="Cité des sciences et Palais de la découverte">Cité des sciences et Palais de la découverte</option> <option value="National Museum of the History of Immigration">National Museum of the History of Immigration</option> <option value="CNES National Center for Space Studies">CNES National Center for Space Studies</option> <option value="CNRS National Center for Scientific Research">CNRS National Center for Scientific Research</option> <option value="GENOPOLE France’s leading biocluster for biotechnologies and research in genomics and genetics">GENOPOLE France’s leading biocluster for biotechnologies and research in genomics and genetics</option> <option value="IFE French Institute of Education">IFE French Institute of Education</option> <option value="IFREMER French Research Institute for Exploitation of the Sea">IFREMER French Research Institute for Exploitation of the Sea</option> <option value="IFPEN Research and training player in the ﬁelds of energy, transport and the environment">IFPEN Research and training player in the ﬁelds of energy, transport and the environment</option> <option value="IFSTTAR French Institute of science and technology for transport, development and networks">IFSTTAR French Institute of science and technology for transport, development and networks</option> <option value="INCA National Institute of cancer">INCA National Institute of cancer</option> <option value="INED National Institute for Demographic Studies">INED National Institute for Demographic Studies</option> <option value="INERIS National Institute for the Industrial Environment and Risks">INERIS National Institute for the Industrial Environment and Risks</option> <option value="INRA National Institute of Agronomic Research">INRA National Institute of Agronomic Research</option> <option value="INRIA National Institute for Research in Computer Science and Automation">INRIA National Institute for Research in Computer Science and Automation</option> <option value="INSERM National Institute of Health and Medical Research">INSERM National Institute of Health and Medical Research</option> <option value="Curie Institute">Curie Institute</option> <option value="Pasteur Institute">Pasteur Institute</option> <option value="IPEV French Polar Institute Paul Emile Victor">IPEV French Polar Institute Paul Emile Victor</option> <option value="I.R.D. Research Institute for Development">I.R.D. Research Institute for Development</option> <option value="I.R.S.N. Institute for Radiation Protection and Nuclear Safety">I.R.S.N. Institute for Radiation Protection and Nuclear Safety</option> <option value="IRSTEA National Science and Technology Research Institute for Environment and Agriculture">IRSTEA National Science and Technology Research Institute for Environment and Agriculture</option> <option value="M.N.H.N National Museum of Natural History">M.N.H.N National Museum of Natural History</option> <option value="Quai Branly Museum">Quai Branly Museum</option> <option value="ONERA National Office for Aeronautical Studies and Research">ONERA National Office for Aeronautical Studies and Research</option> <option value="OSEO">OSEO</option> <option value="O.S.T. Science and Technology Observatory">O.S.T. Science and Technology Observatory</option> <option value="RENATER National Telecommunication Network for Technology, Education and Research">RENATER National Telecommunication Network for Technology, Education and Research</option>  </select><i class="dropdown icon"></i><input class="search" autocomplete="off" tabindex="0"><div class="text">'+values[1]+'</div><div class="menu" tabindex="-1"><div class="item" data-value="ADIT Agency for the dissemination of technological information">ADIT Agency for the dissemination of technological information</div><div class="item" data-value="ANDRA National Agency for Radioactive Waste Management">ANDRA National Agency for Radioactive Waste Management</div><div class="item" data-value="B.R.G.M. THE FRENCH GEOLOGICAL SURVEY">B.R.G.M. THE FRENCH GEOLOGICAL SURVEY</div><div class="item" data-value="C.E.A. The French Alternative Energies and Atomic Energy Commission">C.E.A. The French Alternative Energies and Atomic Energy Commission</div><div class="item" data-value="C.E.E. Center for Employment Studies">C.E.E. Center for Employment Studies</div><div class="item" data-value="CEPH Human plymorphism Study Center">CEPH Human plymorphism Study Center</div><div class="item" data-value="CIRAD Agricultural Research for development">CIRAD Agricultural Research for development</div><div class="item" data-value="Cité des sciences et Palais de la découverte">Cité des sciences et Palais de la découverte</div><div class="item" data-value="National Museum of the History of Immigration">National Museum of the History of Immigration</div><div class="item" data-value="CNES National Center for Space Studies">CNES National Center for Space Studies</div><div class="item" data-value="CNRS National Center for Scientific Research">CNRS National Center for Scientific Research</div><div class="item" data-value="GENOPOLE France’s leading biocluster for biotechnologies and research in genomics and genetics">GENOPOLE France’s leading biocluster for biotechnologies and research in genomics and genetics</div><div class="item" data-value="IFE French Institute of Education">IFE French Institute of Education</div><div class="item" data-value="IFREMER French Research Institute for Exploitation of the Sea">IFREMER French Research Institute for Exploitation of the Sea</div><div class="item" data-value="IFPEN Research and training player in the ﬁelds of energy, transport and the environment">IFPEN Research and training player in the ﬁelds of energy, transport and the environment</div><div class="item" data-value="IFSTTAR French Institute of science and technology for transport, development and networks">IFSTTAR French Institute of science and technology for transport, development and networks</div><div class="item" data-value="INCA National Institute of cancer">INCA National Institute of cancer</div><div class="item" data-value="INED National Institute for Demographic Studies">INED National Institute for Demographic Studies</div><div class="item" data-value="INERIS National Institute for the Industrial Environment and Risks">INERIS National Institute for the Industrial Environment and Risks</div><div class="item" data-value="INRA National Institute of Agronomic Research">INRA National Institute of Agronomic Research</div><div class="item" data-value="INRIA National Institute for Research in Computer Science and Automation">INRIA National Institute for Research in Computer Science and Automation</div><div class="item" data-value="INSERM National Institute of Health and Medical Research">INSERM National Institute of Health and Medical Research</div><div class="item" data-value="Curie Institute">Curie Institute</div><div class="item" data-value="Pasteur Institute">Pasteur Institute</div><div class="item" data-value="IPEV French Polar Institute Paul Emile Victor">IPEV French Polar Institute Paul Emile Victor</div><div class="item" data-value="I.R.D. Research Institute for Development">I.R.D. Research Institute for Development</div><div class="item" data-value="I.R.S.N. Institute for Radiation Protection and Nuclear Safety">I.R.S.N. Institute for Radiation Protection and Nuclear Safety</div><div class="item" data-value="IRSTEA National Science and Technology Research Institute for Environment and Agriculture">IRSTEA National Science and Technology Research Institute for Environment and Agriculture</div><div class="item" data-value="M.N.H.N National Museum of Natural History">M.N.H.N National Museum of Natural History</div><div class="item" data-value="Quai Branly Museum">Quai Branly Museum</div><div class="item" data-value="ONERA National Office for Aeronautical Studies and Research">ONERA National Office for Aeronautical Studies and Research</div><div class="item" data-value="OSEO">OSEO</div><div class="item" data-value="O.S.T. Science and Technology Observatory">O.S.T. Science and Technology Observatory</div><div class="item" data-value="RENATER National Telecommunication Network for Technology, Education and Research">RENATER National Telecommunication Network for Technology, Education and Research</div></div></div><span class="help-block jsonform-errortext" style="display:none;"></span></div></div></div></li>');
                                                  

                                                  } else {
                                                      $('.institutions input.search').val(values[1]);
                                                      $('.institutions div.text').html('');

                                                  }
                                              }


                                          }


                                           if (value == "DATA_DESCRIPTION") {
                                              $("textarea[name='description']").val(values[1]);
                                          }
                                          if (value == "LANGUAGE") {
                                            
                                              $("select[name='language']").val(values[1]);
                                          }


                                         
                                         
                                          
                                      }
                                  });
                              });
                          }
                      }
                      $('#inputs').append('<div class="text" id="filenamemetadata">' + file['name'] + ' successfully loaded!</div>')
                  } else {
                      alert("Only CSV file are supported!")
                  }
              }
              document.getElementById('metadatafile').addEventListener('change', handleFileSelect, false);



	</script>
	<style type="text/css">

	._jsonform-array-buttons{

		float:right;
	}
	legend{
		border-bottom: none!important;
	}
	.accordion{
		padding-bottom: 10px;
	}


		html{
			font-size: 14px!important;
		}
		.modal{
			bottom:inherit!important;			
		}
		

		.expandable{
			cursor:  pointer;
		}
		select:disabled{
			background-color: #e8e8e8!important;
		}
		.ui.error.message{
			margin-top:9%;
		}

	</style>
